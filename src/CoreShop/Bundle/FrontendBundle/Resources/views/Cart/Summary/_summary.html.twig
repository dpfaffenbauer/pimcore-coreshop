{% import "@CoreShopFrontend/Common/Macro/currency.html.twig" as currency %}
{% form_theme form 'bootstrap_4_layout.html.twig' %}

{% set shipping = cart.shipping(false) %}
{% set shippingIt = cart.shipping(true) %}
{% set discount = cart.discount(false) %}
{% set discountIt = cart.discount(true) %}
{% set taxes = cart.taxes %}

<div class="input-group mt-3 mt-md-0">
    {{ form_widget(form.cartRuleCoupon, coreshop_test_form_attribute('voucher-code')|coreshop_merge_recursive( { attr: {placeholder: 'coreshop.ui.voucher.code'|trans}})) }}
    {{ form_widget(form.submit_voucher, coreshop_test_form_attribute('apply-voucher-button')|coreshop_merge_recursive( { attr: { class: 'd-flex align-items-center justify-content-center btn btn-secondary btn btn-secondary' }, label: 'coreshop.ui.voucher.apply_code'|trans })) }}
</div>

{% include '@CoreShopFrontend/Cart/Summary/_rules.html.twig' %}
<hr>

<div class="d-flex justify-content-between gap-2">
    <strong>{{ 'coreshop.ui.subtotal_inc'|trans }}:</strong>{{ currency.convertAndFormat(cart.subtotal(true)) }}
</div>

<div class="d-flex justify-content-between gap-2">
    <strong>{{ 'coreshop.ui.subtotal_excl'|trans }}:</strong> {{ currency.convertAndFormat(cart.subtotal(false)) }}
</div>

{% if discount != 0 %}
    <div class="d-flex justify-content-between gap-2">
        <strong>{{ discount > 0 ? 'coreshop.ui.surcharge_incl'|trans : 'coreshop.ui.discount_incl'|trans }}:</strong> {{ currency.convertAndFormat(cart.subtotal(false)) }} {{ currency.convertAndFormat(discountIt) }}
    </div>

    <div class="d-flex justify-content-between gap-2">
        <strong>{{ discount > 0 ? 'coreshop.ui.surcharge_excl'|trans : 'coreshop.ui.discount_excl'|trans }}:</strong> {{ currency.convertAndFormat(discount) }}
    </div>

{% endif %}
{% if shipping > 0 %}
    <div class="d-flex justify-content-between gap-2">
        <strong>{{ 'coreshop.ui.shipping_incl'|trans }}:</strong> {{ currency.convertAndFormat(shippingIt) }}
    </div>
    <div class="d-flex justify-content-between gap-2">
        <strong>{{ 'coreshop.ui.shipping_excl'|trans }}:</strong> {{ currency.convertAndFormat(shipping) }}
    </div>

{% endif %}
{% for taxItem in taxes %}
    <div class="d-flex justify-content-between gap-2">
        <strong>{{ 'coreshop.ui.tax_name'|trans|format(taxItem.name) }}:</strong> {{ currency.convertAndFormat(taxItem.amount) }}
    </div>
{% endfor %}
<div class="d-flex justify-content-between gap-2">
    <strong>{{ 'coreshop.ui.total_tax'|trans }}:</strong> {{ currency.convertAndFormat(cart.totalTax) }}
</div>
<div class="d-flex justify-content-between gap-2">
    <strong>{{ 'coreshop.ui.total'|trans }}:</strong> {{ currency.convertAndFormat(cart.total) }}
</div>

{% if cart.comment is not empty %}
    <div class="d-flex justify-content-between gap-2">
        <strong>{{ 'coreshop.ui.comment'|trans }}</strong>: {{ cart.comment|nl2br }}
    </div>
{% endif %}

<hr>